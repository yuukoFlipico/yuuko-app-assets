"use strict";(()=>{var I=document.querySelector('[flipico-cart="cart-button"]'),p=document.querySelector('[flipico-cart="added-to-cart-modal"]');async function b(){try{let r=await(await fetch("https://koszyk.inspiredbyid.com/api/cart",{credentials:"include"})).json();if(!Array.isArray(r))throw new Error("Received data is not an array");return r}catch(t){return console.error("Failed to fetch cart items:",t),[]}}async function h(){try{let t=u=>u.toLocaleString("pl-PL",{minimumFractionDigits:2,maximumFractionDigits:2}),r=document.querySelector('[flipico-cart="state-default"]'),e=document.querySelector('[flipico-cart="state-empty"]'),i=await b();await L(i)||console.log("Stany magazynowe zosta\u0142y zaktualizowane."),i=await b();let o=i.reduce((u,m)=>u+m.price*m.quantity,0),l=document.querySelector('[flipico-cart="total-amount"]'),n=document.querySelector('[flipico-cart="quantity-counter"]'),a=document.querySelectorAll('[flipico-cart="remaining-to-free-shipping-wrapper"]'),s=document.querySelectorAll('[flipico-cart="free-shipping-wrapper"]');l&&(l.textContent=`${t(o)} z\u0142`),n&&(n.textContent=i.reduce((u,m)=>u+m.quantity,0).toString()),window.location.pathname==="/koszyk"&&I&&I.remove(),a.forEach(u=>u.classList.add("hide")),s.forEach(u=>u.classList.add("hide")),r&&e&&(i.length>0?(r.style.display="block",e.style.display="none"):(r.style.display="none",e.style.display="flex")),$(i)}catch(t){console.error("Failed to update cart UI:",t)}}async function T(t){t.preventDefault();let e=t.currentTarget.closest('[flipico-cart="add-to-cart-form"]');if(!e){console.error("Form element not found");return}let i=e.getAttribute("flipico-product-id");if(!i){console.error("Product ID not found");return}let c=e.querySelectorAll('[flipico-cart="variant-list"]'),o={},l=null;c.forEach(d=>{let y=d.querySelector("label")?.textContent?.trim()||"Wariant",g=d.querySelector('[flipico-cart="add-to-cart-pill"][aria-checked="true"]');if(!g)throw alert(`Prosz\u0119 wybra\u0107 opcj\u0119: ${y}`),new Error(`Missing selection for ${y}`);let x=g.dataset.optionValue||"";o[y.toLowerCase()]=x;let w=g.dataset.stockQuantity;w!=null&&(l=parseInt(w,10))});let n=e.querySelector('[flipico-cart="add-to-cart-quantity"]'),a=n?parseInt(n.value):1,f=(await b()).find(d=>d.id===i&&(d.size||"")===(o.rozmiar||"")&&(d.color||"")===(o.kolor||"")),u=f?f.quantity:0,m=u+a;if(l!==null&&m>l){alert(`W koszyku masz ju\u017C ${u} szt. tego wariantu. \u0141\u0105cznie pr\xF3bujesz doda\u0107 ${m}, ale dost\u0119pnych jest tylko ${l}.`);return}try{let d=await k(i),y={price:d.fieldData.pricePromo?d.fieldData.pricePromo:d.fieldData.priceNormal,quantity:a,size:o.rozmiar||"",color:o.kolor||"",baselinker_id:d.fieldData.baselinker_id,name:d.fieldData.name,...d};console.log("selectedItem: ",y),await S(y,{skipModal:!1})}catch(d){console.error("Error getting selected item:",d)}}async function S(t,r){try{let e=await fetch("https://koszyk.inspiredbyid.com/api/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error(`Failed to add item to cart: ${e.statusText}`);await h(),p&&!r.skipModal&&(p.style.display="flex",p.style.opacity="0",p.style.transition="opacity 0.5s ease",setTimeout(()=>{p.style.opacity="1"},10),setTimeout(()=>{p.style.opacity="0",setTimeout(()=>{p.style.display="none"},500)},1500))}catch(e){console.error("Failed to add item to cart:",e)}}async function v(t,r,e){try{await fetch(`https://koszyk.inspiredbyid.com/api/cart/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({size:r,color:e}),credentials:"include"}),await h()}catch(i){console.error("Failed to remove item from cart:",i)}}async function D(t,r,e,i){try{let c=await k(t);if(!c){console.error("Brak szczeg\xF3\u0142\xF3w produktu, nie mo\u017Cna zaktualizowa\u0107 ilo\u015Bci.");return}let o=null;if(c.fieldData.stockNumber!==void 0&&c.fieldData.stockNumber!==null&&(o=parseInt(c.fieldData.stockNumber.toString(),10)),c.fieldData.sizes&&typeof c.fieldData.sizes=="string"&&c.fieldData.stockNumber){let l=c.fieldData.sizes.split(",").map(s=>s.trim()),n=c.fieldData.stockNumber.toString().split(",").map(s=>parseInt(s.trim(),10)),a=l.findIndex(s=>s===e);a!==-1&&n[a]!==void 0&&(o=n[a])}if(o!==null&&r>o){alert(`W magazynie jest tylko ${o} sztuk tego wariantu.`);let l=document.querySelector(`.cart-item[flipico-product-id="${t}"][flipico-product-size="${e}"][flipico-product-color="${i}"]`);if(l){let n=l.querySelector('[flipico-cart="update-quantity"]');n&&(n.value=o.toString())}return}await fetch(`https://koszyk.inspiredbyid.com/api/cart/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:r,size:e,color:i}),credentials:"include"}),await h()}catch(c){console.error("Failed to update item quantity:",c)}}function $(t){let r=document.querySelector('[flipico-cart="cart-list"]');if(!r)return;let e=o=>o.toLocaleString("pl-PL",{minimumFractionDigits:2,maximumFractionDigits:2});r.innerHTML="",t.forEach(o=>{let l=o.size?`<div class="text-color-brand">Rozmiar: ${o.size}</div>`:"",n=o.color?`<div class="text-color-brand">Kolor: ${o.color}</div>`:"",a=document.createElement("div");a.className="cart-item",a.setAttribute("flipico-product-id",o.id),a.setAttribute("flipico-product-size",o.size||""),a.setAttribute("flipico-product-color",o.color||""),a.innerHTML=`
      <img src="${o.fieldData.thumbnail.url}" loading="lazy" alt="${o.fieldData.name}" class="image-3">
      <a href="/produkt/${o.fieldData.slug}" class="product-link">
        <div style="max-width: fit-content">
          <div class="text-weight-bold text-style-2lines">${o.fieldData.name}</div>
          <div>
            <div class="text-color-brand">Cena: ${e(o.price)} z\u0142</div>
            <div class="text-color-brand">Ilo\u015B\u0107: ${o.quantity}</div>
            ${l}
            ${n}
          </div>
        </div>
      </a>
      <input 
        class="form_input-3 is-quantity-input w-input"
        maxlength="256"
        value="${o.quantity}"
        type="number"
        min="1"
        flipico-cart="update-quantity"
      />
      <div class="icon-embed-xsmall w-embed remove-from-cart" flipico-cart="remove-from-cart">
        <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="100%" height="100%" viewBox="0 0 24 24">
          <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 6L6 18M6 6l12 12"></path>
        </svg>
      </div>
    `,r.appendChild(a)}),document.querySelectorAll('[flipico-cart="update-quantity"]').forEach(o=>{o.addEventListener("change",async l=>{let n=l.currentTarget,a=parseInt(n.value,10);if(isNaN(a)||a<1)return;let s=n.closest(".cart-item");if(!s)return;let f=s.getAttribute("flipico-product-id"),u=s.getAttribute("flipico-product-size")||"",m=s.getAttribute("flipico-product-color")||"";f&&await D(f,a,u,m)})}),document.querySelectorAll('[flipico-cart="remove-from-cart"]').forEach(o=>{o.addEventListener("click",async l=>{let n=l.currentTarget.closest(".cart-item");if(!n){console.error("Parent item not found");return}let a=n.getAttribute("flipico-product-id"),s=n.getAttribute("flipico-product-size"),f=n.getAttribute("flipico-product-color");a&&await v(a,s||"",f||"")})})}function C(t){let r=e=>e===""||e===null||e===void 0;return{id:t.id,cmsLocaleId:t.cmsLocaleId,lastPublished:r(t.lastPublished)?null:t.lastPublished,lastUpdated:r(t.lastUpdated)?null:t.lastUpdated,createdOn:r(t.createdOn)?null:t.createdOn,isArchived:t.isArchived??!1,isDraft:t.isDraft??!1,fieldData:{priceNormal:r(t.fieldData.cena)?0:t.fieldData.cena,pricePromo:r(t.fieldData["cena-promocyjna"])?0:t.fieldData["cena-promocyjna"],stockNumber:r(t.fieldData["ilosc-sztuk-2"])?0:t.fieldData["ilosc-sztuk-2"],name:r(t.fieldData.name)?"":t.fieldData.name,description:r(t.fieldData.opis)?"":t.fieldData.opis,thumbnail:{fileId:r(t.fieldData["zdjecie-glowne"]?.fileId)?"":t.fieldData["zdjecie-glowne"]?.fileId,url:r(t.fieldData["zdjecie-glowne"]?.url)?"":t.fieldData["zdjecie-glowne"]?.url,alt:r(t.fieldData["zdjecie-glowne"]?.alt)?null:t.fieldData["zdjecie-glowne"]?.alt},gallery:Array.isArray(t.fieldData["wiecej-zdjec"])?t.fieldData["wiecej-zdjec"].map(e=>({fileId:r(e.fileId)?"":e.fileId,url:r(e.url)?"":e.url,alt:r(e.alt)?null:e.alt})):[],slug:r(t.fieldData.slug)?"":t.fieldData.slug,category:r(t.fieldData.kategoria)?"":t.fieldData.kategoria,baselinker_id:t.fieldData["baselinker-id"]??!1,colors:t.fieldData.kolor??!1,sizes:t.fieldData.rozmiar??!1}}}async function k(t){try{let r=await fetch(`https://koszyk.inspiredbyid.com/api/products/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`Failed to fetch product details for ID: ${t}`);let e=await r.json(),i=C(e);return console.log(`Response for product ID ${t}:`,i),i}catch(r){return console.error("Error fetching product details:",r),null}}async function L(t){let r=!0;for(let e of t){let i=await k(e.id);if(!i)return alert(`Nie uda\u0142o si\u0119 pobra\u0107 danych produktu "${e.fieldData.name}".`),!1;let c=null;if(i.fieldData.stockNumber!==void 0&&i.fieldData.stockNumber!==null&&(c=parseInt(i.fieldData.stockNumber.toString(),10)),i.fieldData.sizes&&typeof i.fieldData.sizes=="string"&&i.fieldData.stockNumber){let o=i.fieldData.sizes.split(",").map(a=>a.trim()),l=i.fieldData.stockNumber.toString().split(",").map(a=>parseInt(a.trim(),10)),n=o.findIndex(a=>a===(e.size||""));n!==-1&&l[n]!==void 0&&(c=l[n])}if(c!==null){if(c===0){alert(`Produkt "${e.fieldData.name}" (${e.size||""}) jest ju\u017C niedost\u0119pny i zosta\u0142 usuni\u0119ty z koszyka.`),await v(e.id,e.size||"",e.color||""),r=!1;continue}c<e.quantity&&(alert(`Produkt "${e.fieldData.name}" (${e.size||""}) ma tylko ${c} szt. Zmienili\u015Bmy ilo\u015B\u0107 w koszyku.`),await D(e.id,c,e.size||"",e.color||""),r=!1)}}return r}async function z(){await h(),document.querySelectorAll('[flipico-cart="add-to-cart"]').forEach(t=>{t.addEventListener("click",T)})}function E(){console.log("%c \u2764\uFE0F Flipico Components ",`
      background: linear-gradient(135deg, #7b2cff, #c799ff);
      color: #fff;
      font-weight: bold;
      font-size: 20px;
      padding: 8px 16px;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(123, 44, 255, 0.6);
      display: inline-block;
    `),console.log("%c\u2728 This system was lovingly crafted by Flipico Agency.",`
      background: #ffffff;
      color: #333;
      font-size: 15px;
      padding: 6px 10px;
      border: 1px solid #eee;
      border-radius: 6px;
    `),console.log("%c\u{1F680} Powered by %ccustom attributes %c(flipico-cart)%c, %cStripe%c payments, %cInPost%c parcel integration, and %cBaseLinker synchronization.","color: #555;","color: #555;","color: #7b2cff; font-weight: bold;","color: #555;","color: #635BFF; font-weight: bold;","color: #555;","color: #ffcc00; font-weight: bold;","color: #555;","color: #00b2a9; font-weight: bold;"),console.log("%c\u{1F4A1} Tip: Embrace innovation. Build with Flipico.",`
      color: #7b2cff;
      font-size: 13px;
      font-style: italic;
    `)}var q=async()=>{window.Webflow||=[],window.Webflow.push(async()=>{if(!window.isWebflowInitialized){window.isWebflowInitialized=!0,E();try{let t=new URLSearchParams(window.location.search),r=t.get("redirect_status")??"",e=t.get("payment_intent")??"",i=localStorage.getItem("payment_intent")??"";r==="succeeded"?e!==i?(localStorage.setItem("payment_intent",e),setTimeout(()=>{window.location.reload()},2e3)):await z():await z()}catch(t){console.error("B\u0142\u0105d podczas obs\u0142ugi Webflow:",t)}}})};q();})();
