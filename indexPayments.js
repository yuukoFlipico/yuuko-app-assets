"use strict";(()=>{var j=document.querySelector('[flipico-cart="cart-button"]'),le=document.querySelector('[flipico-cart="added-to-cart-modal"]');async function q(){try{let t=await(await fetch("https://koszyk.inspiredbyid.com/api/cart",{credentials:"include"})).json();if(!Array.isArray(t))throw new Error("Received data is not an array");return t}catch(e){return console.error("Failed to fetch cart items:",e),[]}}async function A(){try{let e=u=>u.toLocaleString("pl-PL",{minimumFractionDigits:2,maximumFractionDigits:2}),t=document.querySelector('[flipico-cart="state-default"]'),o=document.querySelector('[flipico-cart="state-empty"]'),i=await q();await x(i)||console.log("Stany magazynowe zosta\u0142y zaktualizowane."),i=await q();let n=i.reduce((u,p)=>u+p.price*p.quantity,0),l=document.querySelector('[flipico-cart="total-amount"]'),c=document.querySelector('[flipico-cart="quantity-counter"]'),a=document.querySelectorAll('[flipico-cart="remaining-to-free-shipping-wrapper"]'),s=document.querySelectorAll('[flipico-cart="free-shipping-wrapper"]');l&&(l.textContent=`${e(n)} z\u0142`),c&&(c.textContent=i.reduce((u,p)=>u+p.quantity,0).toString()),window.location.pathname==="/koszyk"&&j&&j.remove(),a.forEach(u=>u.classList.add("hide")),s.forEach(u=>u.classList.add("hide")),t&&o&&(i.length>0?(t.style.display="block",o.style.display="none"):(t.style.display="none",o.style.display="flex")),te(i)}catch(e){console.error("Failed to update cart UI:",e)}}async function $(e,t,o){try{await fetch(`https://koszyk.inspiredbyid.com/api/cart/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({size:t,color:o}),credentials:"include"}),await A()}catch(i){console.error("Failed to remove item from cart:",i)}}async function N(e,t,o,i){try{let r=await O(e);if(!r){console.error("Brak szczeg\xF3\u0142\xF3w produktu, nie mo\u017Cna zaktualizowa\u0107 ilo\u015Bci.");return}let n=null;if(r.fieldData.stockNumber!==void 0&&r.fieldData.stockNumber!==null&&(n=parseInt(r.fieldData.stockNumber.toString(),10)),r.fieldData.sizes&&typeof r.fieldData.sizes=="string"&&r.fieldData.stockNumber){let l=r.fieldData.sizes.split(",").map(s=>s.trim()),c=r.fieldData.stockNumber.toString().split(",").map(s=>parseInt(s.trim(),10)),a=l.findIndex(s=>s===o);a!==-1&&c[a]!==void 0&&(n=c[a])}if(n!==null&&t>n){alert(`W magazynie jest tylko ${n} sztuk tego wariantu.`);let l=document.querySelector(`.cart-item[flipico-product-id="${e}"][flipico-product-size="${o}"][flipico-product-color="${i}"]`);if(l){let c=l.querySelector('[flipico-cart="update-quantity"]');c&&(c.value=n.toString())}return}await fetch(`https://koszyk.inspiredbyid.com/api/cart/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:t,size:o,color:i}),credentials:"include"}),await A()}catch(r){console.error("Failed to update item quantity:",r)}}function te(e){let t=document.querySelector('[flipico-cart="cart-list"]');if(!t)return;let o=n=>n.toLocaleString("pl-PL",{minimumFractionDigits:2,maximumFractionDigits:2});t.innerHTML="",e.forEach(n=>{let l=n.size?`<div class="text-color-brand">Rozmiar: ${n.size}</div>`:"",c=n.color?`<div class="text-color-brand">Kolor: ${n.color}</div>`:"",a=document.createElement("div");a.className="cart-item",a.setAttribute("flipico-product-id",n.id),a.setAttribute("flipico-product-size",n.size||""),a.setAttribute("flipico-product-color",n.color||""),a.innerHTML=`
      <img src="${n.fieldData.thumbnail.url}" loading="lazy" alt="${n.fieldData.name}" class="image-3">
      <a href="/produkt/${n.fieldData.slug}" class="product-link">
        <div style="max-width: fit-content">
          <div class="text-weight-bold text-style-2lines">${n.fieldData.name}</div>
          <div>
            <div class="text-color-brand">Cena: ${o(n.price)} z\u0142</div>
            <div class="text-color-brand">Ilo\u015B\u0107: ${n.quantity}</div>
            ${l}
            ${c}
          </div>
        </div>
      </a>
      <input 
        class="form_input-3 is-quantity-input w-input"
        maxlength="256"
        value="${n.quantity}"
        type="number"
        min="1"
        flipico-cart="update-quantity"
      />
      <div class="icon-embed-xsmall w-embed remove-from-cart" flipico-cart="remove-from-cart">
        <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="100%" height="100%" viewBox="0 0 24 24">
          <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 6L6 18M6 6l12 12"></path>
        </svg>
      </div>
    `,t.appendChild(a)}),document.querySelectorAll('[flipico-cart="update-quantity"]').forEach(n=>{n.addEventListener("change",async l=>{let c=l.currentTarget,a=parseInt(c.value,10);if(isNaN(a)||a<1)return;let s=c.closest(".cart-item");if(!s)return;let d=s.getAttribute("flipico-product-id"),u=s.getAttribute("flipico-product-size")||"",p=s.getAttribute("flipico-product-color")||"";d&&await N(d,a,u,p)})}),document.querySelectorAll('[flipico-cart="remove-from-cart"]').forEach(n=>{n.addEventListener("click",async l=>{let c=l.currentTarget.closest(".cart-item");if(!c){console.error("Parent item not found");return}let a=c.getAttribute("flipico-product-id"),s=c.getAttribute("flipico-product-size"),d=c.getAttribute("flipico-product-color");a&&await $(a,s||"",d||"")})})}function F(e){document.querySelectorAll('[flipico-cart="checkout-list"]').forEach(o=>{if(o){let i=r=>r.toLocaleString("pl-PL",{minimumFractionDigits:2,maximumFractionDigits:2});o.innerHTML="",e.forEach(r=>{let n=r.size?`<div class="text-color-brand">Rozmiar: ${r.size}</div>`:"",l=r.color?`<div class="text-color-brand">Kolor: ${r.color}</div>`:"",c=r.fieldData.thumbnail.url,a=document.createElement("div");a.className="w-commerce-commercecheckoutorderitem order-item",a.innerHTML=`
          <img src="${c}" alt="${r.fieldData.name}" class="w-commerce-commercecartitemimage image-3">
          <div class="w-commerce-commercecheckoutorderitemdescriptionwrapper">
            <div class="w-commerce-commerceboldtextblock">${r.fieldData.name}</div>
            <div class="w-commerce-commercecheckoutorderitemquantitywrapper" style="flex-direction: column">
              <div>Ilo\u015B\u0107: ${r.quantity}</div>
              ${n}
              ${l}
            </div>
          </div>
          <div>${i(r.price)} z\u0142</div>
        `,o.appendChild(a)})}})}function oe(e){let t=o=>o===""||o===null||o===void 0;return{id:e.id,cmsLocaleId:e.cmsLocaleId,lastPublished:t(e.lastPublished)?null:e.lastPublished,lastUpdated:t(e.lastUpdated)?null:e.lastUpdated,createdOn:t(e.createdOn)?null:e.createdOn,isArchived:e.isArchived??!1,isDraft:e.isDraft??!1,fieldData:{priceNormal:t(e.fieldData.cena)?0:e.fieldData.cena,pricePromo:t(e.fieldData["cena-promocyjna"])?0:e.fieldData["cena-promocyjna"],stockNumber:t(e.fieldData["ilosc-sztuk-2"])?0:e.fieldData["ilosc-sztuk-2"],name:t(e.fieldData.name)?"":e.fieldData.name,description:t(e.fieldData.opis)?"":e.fieldData.opis,thumbnail:{fileId:t(e.fieldData["zdjecie-glowne"]?.fileId)?"":e.fieldData["zdjecie-glowne"]?.fileId,url:t(e.fieldData["zdjecie-glowne"]?.url)?"":e.fieldData["zdjecie-glowne"]?.url,alt:t(e.fieldData["zdjecie-glowne"]?.alt)?null:e.fieldData["zdjecie-glowne"]?.alt},gallery:Array.isArray(e.fieldData["wiecej-zdjec"])?e.fieldData["wiecej-zdjec"].map(o=>({fileId:t(o.fileId)?"":o.fileId,url:t(o.url)?"":o.url,alt:t(o.alt)?null:o.alt})):[],slug:t(e.fieldData.slug)?"":e.fieldData.slug,category:t(e.fieldData.kategoria)?"":e.fieldData.kategoria,baselinker_id:e.fieldData["baselinker-id"]??!1,colors:e.fieldData.kolor??!1,sizes:e.fieldData.rozmiar??!1}}}async function O(e){try{let t=await fetch(`https://koszyk.inspiredbyid.com/api/products/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to fetch product details for ID: ${e}`);let o=await t.json(),i=oe(o);return console.log(`Response for product ID ${e}:`,i),i}catch(t){return console.error("Error fetching product details:",t),null}}async function _(){try{return(await(await fetch("https://koszyk.inspiredbyid.com/api/session-id",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})).json()).sessionID}catch(e){return console.error("B\u0142\u0105d podczas pobierania ID sesji:",e),null}}var Z=async(e,t,o,i,r,n,l)=>{try{return await(await fetch("https://koszyk.inspiredbyid.com/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({total_amount:Math.round(e*100),currency:"PLN",shipping_cost:Math.round(o*100),tax_cost:Math.round(r*100),customer_email:n.email,customer_name:n.name,shipping_address:{address_line1:n.address,address_line2:n.parcelMachine,city:n.city,postal_code:n.zip,country:n.country},nip:n.nip,phone:n.phone,additional_info:n.additionalInfo,shipping_choice:i,company_name:n.companyName,company_address:n.companyAddress,company_zip:n.companyZIP,company_city:n.companyCity,sessionID:l})})).json()}catch(c){return console.error("Error creating payment intent:",c),null}};async function x(e){let t=!0;for(let o of e){let i=await O(o.id);if(!i)return alert(`Nie uda\u0142o si\u0119 pobra\u0107 danych produktu "${o.fieldData.name}".`),!1;let r=null;if(i.fieldData.stockNumber!==void 0&&i.fieldData.stockNumber!==null&&(r=parseInt(i.fieldData.stockNumber.toString(),10)),i.fieldData.sizes&&typeof i.fieldData.sizes=="string"&&i.fieldData.stockNumber){let n=i.fieldData.sizes.split(",").map(a=>a.trim()),l=i.fieldData.stockNumber.toString().split(",").map(a=>parseInt(a.trim(),10)),c=n.findIndex(a=>a===(o.size||""));c!==-1&&l[c]!==void 0&&(r=l[c])}if(r!==null){if(r===0){alert(`Produkt "${o.fieldData.name}" (${o.size||""}) jest ju\u017C niedost\u0119pny i zosta\u0142 usuni\u0119ty z koszyka.`),await $(o.id,o.size||"",o.color||""),t=!1;continue}r<o.quantity&&(alert(`Produkt "${o.fieldData.name}" (${o.size||""}) ma tylko ${r} szt. Zmienili\u015Bmy ilo\u015B\u0107 w koszyku.`),await N(o.id,r,o.size||"",o.color||""),t=!1)}}return t}function B(){console.log("%c \u2764\uFE0F Flipico Components ",`
      background: linear-gradient(135deg, #7b2cff, #c799ff);
      color: #fff;
      font-weight: bold;
      font-size: 20px;
      padding: 8px 16px;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(123, 44, 255, 0.6);
      display: inline-block;
    `),console.log("%c\u2728 This system was lovingly crafted by Flipico Agency.",`
      background: #ffffff;
      color: #333;
      font-size: 15px;
      padding: 6px 10px;
      border: 1px solid #eee;
      border-radius: 6px;
    `),console.log("%c\u{1F680} Powered by %ccustom attributes %c(flipico-cart)%c, %cStripe%c payments, %cInPost%c parcel integration, and %cBaseLinker synchronization.","color: #555;","color: #555;","color: #7b2cff; font-weight: bold;","color: #555;","color: #635BFF; font-weight: bold;","color: #555;","color: #ffcc00; font-weight: bold;","color: #555;","color: #00b2a9; font-weight: bold;"),console.log("%c\u{1F4A1} Tip: Embrace innovation. Build with Flipico.",`
      color: #7b2cff;
      font-size: 13px;
      font-style: italic;
    `)}var U=(e,t,o,i,r,n)=>{let l=m=>m.toLocaleString("pl-PL",{minimumFractionDigits:2,maximumFractionDigits:2}),c=document.querySelector('[flipico-cart="checkout-products-cost"]');c&&(c.textContent=`${l(e)} z\u0142`);let a=document.querySelector('[flipico-cart="checkout-tax"]');a&&(a.textContent=`${l(t)} z\u0142`);let s=document.querySelector('[flipico-cart="checkout-shipping-choice"]');s&&(s.textContent=`${o}`);let d=document.querySelector('[flipico-cart="checkout-shipping-cost"]');d&&(d.textContent=`${l(i)} z\u0142`);let u=document.querySelector('[flipico-cart="checkout-coupon-amount"]');u&&(u.textContent=`${l(n)} z\u0142`);let p=document.querySelector('[flipico-cart="checkout-total"]');p&&(p.textContent=`${l(r)} z\u0142`)};var ne=async e=>{try{return await(await fetch("https://koszyk.inspiredbyid.com/api/validate-coupon",{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({couponCode:e})})).json()}catch(t){return console.error("Error checking coupon:",t),{isValid:!1,discountType:null,amount:0}}};function W(e,t){let o=r=>r.toLocaleString("pl-PL",{minimumFractionDigits:2,maximumFractionDigits:2}),i=document.querySelector('[flipico-cart="apply-coupon"]');if(!i){console.error("Nie znaleziono przycisku kuponu.");return}i.addEventListener("click",async()=>{console.log("Klikni\u0119to przycisk kuponu!");let r=document.querySelector('[flipico-cart="coupon-input"]'),n=document.querySelector('[flipico-cart="coupon-feedback"]');if(!r||!n){console.error("Nie znaleziono elementu formularza kuponu.");return}let l=r.value.trim(),{isValid:c,discountType:a,amount:s}=await ne(l);if(!c){n.textContent="Nieprawid\u0142owy kupon.",n.style.display="block",n.classList.remove("hide");return}let d=e.reduce((m,f)=>m+f.price*f.quantity,0),u=a==="percentage"?d*(s/100):s/100,p=a==="fixed"?`Zni\u017Cka: ${o(s/100)} z\u0142`:`Zni\u017Cka: ${o(s)}%`;n.textContent=`Kupon zosta\u0142 dodany. ${p}`,n.style.display="block",n.classList.remove("hide"),console.log(`Zastosowany rabat: ${u} z\u0142`),t(u)})}var V=()=>{let e=document.querySelector('[flipico-cart="checkout-email"]')?.value||"",t=document.querySelector('[flipico-cart="checkout-name"]')?.value||"",o=document.querySelector('[flipico-cart="checkout-address"]')?.value||"",i=document.querySelector('[flipico-cart="checkout-city"]')?.value||"",r=document.querySelector('[flipico-cart="checkout-zip"]')?.value||"",n=document.querySelector('[flipico-cart="checkout-country"]')?.value||"Poland",l=document.querySelector('[flipico-cart="checkout-nip"]')?.value||"",c=document.querySelector('[flipico-cart="checkout-phone"]')?.value||"",a=document.querySelector('[flipico-cart="checkout-additional-info"]')?.value||"",s=document.querySelector('[flipico-cart="checkout-parcel-input"]')?.value||"",d=document.querySelector('[flipico-cart="checkout-company-name"]')?.value||"",u=document.querySelector('[flipico-cart="checkout-company-address"]')?.value||"",p=document.querySelector('[flipico-cart="checkout-company-zip"]')?.value||"",m=document.querySelector('[flipico-cart="checkout-company-city"]')?.value||"";return{email:e,name:t,address:o,city:i,zip:r,country:n,nip:l,phone:c,additionalInfo:a,parcelMachine:s,companyName:d,companyAddress:u,companyZIP:p,companyCity:m}},H=()=>{try{let e=window.Stripe("pk_live_51RNISMKyJvcscPTIOKRKi4utG0K77l1NTnoFiaqHKXSxdlmorIiTuXColxF4BxT601iU8D1P9gW4wnfBYeEhHogJ002WsoEm0z",{stripeAccount:"acct_1RNISMKyJvcscPTI"});if(!e){console.error("Inicjalizacja Stripe zwr\xF3ci\u0142a warto\u015B\u0107 undefined.");return}return e}catch(e){console.error("B\u0142\u0105d podczas tworzenia instancji Stripe:",e);return}},K=async()=>{if(!H())return console.error("Stripe could not be initialized."),!1;let t=document.querySelector('[flipico-cart="payment_form"]');return t?(t.addEventListener("keydown",o=>{o.key==="Enter"&&o.preventDefault()}),t):(console.error("Payment form not found."),!1)};async function re(){let e=r=>r.toLocaleString("pl-PL",{minimumFractionDigits:2,maximumFractionDigits:2}),t={kurier:document.querySelector('[flipico-cart="courier-cost"]'),inpost:document.querySelector('[flipico-cart="inpost-cost"]')},o=13.99,i=13.99;t.kurier&&(t.kurier.textContent=`${e(o)} z\u0142`),t.inpost&&(t.inpost.textContent=`${e(i)} z\u0142`)}var Q=()=>{let e=document.querySelector('[flipico-cart="cart-button"]');e&&(console.warn("Cart button should not be on cart page"),e.style.display="none");let t=document.querySelector('[flipico-cart="checkout-company-info"]');t&&(t.style.display="none");let o=document.querySelector('[flipico-cart="checkout-next-btn"]'),i=document.querySelector('[flipico-cart="checkout-pay-btn"]'),r=document.querySelector('[flipico-cart="checkout-step-1"]'),n=document.querySelector('[flipico-cart="checkout-step-2"]'),l=document.querySelector('[flipico-cart="checkout-validate-items"]'),c=document.querySelectorAll('input[name="Shipment"]'),a=t?.querySelectorAll("input"),s=document.querySelector('[flipico-cart="checkout-nip"]'),d=document.querySelector('[flipico-cart="checkout-company-checkbox"]'),u=document.querySelector('[flipico-cart="checkout-company-name"]'),p=document.querySelector('[flipico-cart="checkout-company-address"]'),m=document.querySelector('[flipico-cart="checkout-company-zip"]'),f=document.querySelector('[flipico-cart="checkout-company-city"]');s?.removeAttribute("required"),d?.addEventListener("change",()=>{d.checked?(d.previousElementSibling?.classList.add("w--redirected-checked"),s?.setAttribute("required","true"),u?.setAttribute("required","true"),p?.setAttribute("required","true"),m?.setAttribute("required","true"),f?.setAttribute("required","true")):(d.previousElementSibling?.classList.remove("w--redirected-checked"),s?.removeAttribute("required"),u?.removeAttribute("required"),p?.removeAttribute("required"),m?.removeAttribute("required"),f?.removeAttribute("required"))}),c.forEach(()=>{re()}),d&&t&&a&&d.addEventListener("change",function(){d.checked?t.style.display="flex":(t.style.display="none",a.forEach(k=>k.value=""))});function D(){let k=document.querySelectorAll('input[name="Shipment"]');if(k.length===0){console.log("Czekam na renderowanie element\xF3w...");return}function g(y){let E=y.value;k.forEach(v=>{v.closest("label")?.querySelector(".w-form-formradioinput")?.classList.remove("w--redirected-checked")}),y.closest("label")?.querySelector(".w-form-formradioinput")?.classList.add("w--redirected-checked");let w=document.querySelector(".inpost"),h=document.querySelector(".dhl"),z=document.querySelector('[flipico-cart="checkout-parcel-input"]');w&&h&&(E==="InPost Parcel"?(w.style.display="block",h.style.display="none"):E==="DHL Parcel"?(w.style.display="none",h.style.display="block"):(w.style.display="none",h.style.display="none",z?z.value="":console.error("Can not find parcel field input")))}document.querySelectorAll('input[name="Shipment"]').forEach(y=>{y.addEventListener("change",()=>g(y))});let b=document.querySelector('input[name="Shipment"]:checked');b&&g(b)}return new MutationObserver(function(){D()}).observe(document.body,{childList:!0,subtree:!0}),D(),console.log("Zako\u0144czono setupUIElements."),{nextButton:o,payButton:i,stepOneWrapper:r,stepTwoWrapper:n,isItemsInput:l,shippingMethodInputs:c,companyCheckbox:d,nipInput:s,companyNameInput:u,companyAddressInput:p,companyZIPInput:m,companyCityInput:f}};var J=async(e,t)=>{e&&t?(e.style.display="none",t.style.display="flex",window.scrollTo({top:0,behavior:"smooth"})):console.error("One of the step wrappers is not found.")},G=async(e,t,o)=>{e?(t.disabled=!1,t.style.cursor="pointer",t.style.opacity="1",o.value="true"):(t.disabled=!0,t.style.cursor="not-allowed",t.style.opacity="0.5",o.value="",alert("Tw\xF3j koszyk jest pusty. Dodaj przedmioty do koszyka przed przej\u015Bciem do nast\u0119pnego kroku."),window.location.href="/")};var ie=(e,t,o,i)=>{let r=Array.from(e).every(c=>c.value.trim()!==""),n=i.value==="true";r&&n?(o.disabled=!1,o.style.cursor="pointer",o.style.opacity="1",o.style.pointerEvents="auto"):(o.disabled=!0,o.style.cursor="not-allowed",o.style.opacity="0.5",o.style.pointerEvents="none"),o.style.display="block"},Y=(e,t,o)=>{let i=t.querySelectorAll("input[required], select[required]"),r=()=>ie(i,t,e,o);i.forEach(n=>{n.addEventListener("input",r)}),o.addEventListener("input",r),r()},ce=e=>/^\d{10}$/.test(e),X=(e,t,o,i,r,n,l,c)=>{if(i<=2)return alert("Suma produkt\xF3w w koszyku musi wynosi\u0107 wi\u0119cej ni\u017C 2.00 z\u0142, aby kontynuowa\u0107."),!1;let a=document.querySelector('[flipico-cart="checkout-parcel-input"]')?.value.trim()||"";if((e.includes("PACZKOMAT INPOST")||e.includes("AUTOMAT DHL"))&&!(a!==""))return alert("Zaznaczy\u0142e\u015B opcj\u0119 paczkomat\xF3w, lecz nie wybra\u0142e\u015B \u017Cadnego punktu."),!1;let u=t?.checked??!1,p=o?.value.trim()!=="",m=o?.value?ce(o.value.trim()):!0;if(u&&(!p||!m))return alert(p?"Podany NIP jest niepoprawny.":"Zaznaczy\u0142e\u015B opcj\u0119 zakupu jako firma, lecz nie uzupe\u0142ni\u0142e\u015B NIP."),!1;if(u){if(!r?.value.trim())return alert("Zaznaczy\u0142e\u015B opcj\u0119 zakupu jako firma, lecz nie uzupe\u0142ni\u0142e\u015B nazwy firmy."),!1;if(!n?.value.trim())return alert("Zaznaczy\u0142e\u015B opcj\u0119 zakupu jako firma, lecz nie uzupe\u0142ni\u0142e\u015B adresu firmy."),!1;if(!l?.value.trim())return alert("Zaznaczy\u0142e\u015B opcj\u0119 zakupu jako firma, lecz nie uzupe\u0142ni\u0142e\u015B kodu pocztowego firmy."),!1;if(!c?.value.trim())return alert("Zaznaczy\u0142e\u015B opcj\u0119 zakupu jako firma, lecz nie uzupe\u0142ni\u0142e\u015B miasta firmy."),!1}return!0};var ae=async e=>{B();let t=await K();if(!t)return;let o=await q();if(await x(o),o=await q(),o.length===0){alert("Tw\xF3j koszyk jest pusty."),window.location.href="/";return}let{nextButton:i,payButton:r,stepOneWrapper:n,stepTwoWrapper:l,isItemsInput:c,companyCheckbox:a,nipInput:s,companyNameInput:d,companyAddressInput:u,companyZIPInput:p,companyCityInput:m}=Q();if(!n||!l||!c||!r||!i)return;await G(o,r,c),Y(i,n,c);let f=0;W(o,M=>{f=M,console.log("Zaktualizowany rabat:",f)}),F(o),i?.addEventListener("click",async()=>{let M=V(),k=document.querySelector('input[name="Shipment"]:checked'),g=k?.nextElementSibling?.textContent||"Brak wyboru",I=parseFloat(k?.nextElementSibling?.nextElementSibling?.textContent?.replace(" Z\u0141","").trim().replace(",",".")||"0");console.log(g,I);let b=o.reduce((C,S)=>C+S.price*S.quantity,0),y=b*.23,E=b+Number(I)-f;if(!X(g,a,s,E,d,u,p,m))return;U(b,y,g,I,E,f),await J(n,l);let w=await _(),h=await Z(E,o,I,g,y,M,w);if(!h){console.error("Payment intent is missing.");return}let z=document.querySelector('[flipico-cart="stripe"]');if(!z){console.error("Stripe element could not be found. Ensure that the element has the correct flipico-cart attribute.");return}let v=e.elements({clientSecret:h.client_secret});v.create("payment").mount(z),t.addEventListener("submit",async C=>{C.preventDefault(),C.stopPropagation(),await v.submit();let S=await e.confirmPayment({elements:v,clientSecret:h.client_secret,redirect:"always",confirmParams:{return_url:"https://www.inspiredbyid.com/order-summary"}}),T=document.querySelector(".w-form-done"),L=document.querySelector(".w-form-fail"),P=document.querySelector(".container-medium");S.error?(L&&(L.textContent=`P\u0142atno\u015B\u0107 nieudana: ${S.error.message}`,L.style.display="block"),T&&(T.style.display="none")):(T&&(T.textContent="P\u0142atno\u015B\u0107 zako\u0144czona sukcesem!",T.style.display="block"),L&&(L.style.display="none"),P&&(P.style.display="none"))},!0)})};document.addEventListener("DOMContentLoaded",async()=>{let e=H();if(e){if(window.isWebflowInitialized)return;window.isWebflowInitialized=!0,await ae(e)}else console.error("Stripe could not be initialized.")});})();
